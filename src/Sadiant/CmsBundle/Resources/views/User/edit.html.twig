{% extends "SadiantCmsBundle::layout.html.twig" %}

{% block javascripts_assets %}
<script src="{{ asset('bundles/sadiantcms/js/user.js') }}" type="text/javascript"></script>
{% endblock %}

{% set body_class = 'reversed edit_user' %}
{% set tab = 'settings' %}
{% set nav = 'users' %}

{% if user is defined %}
  {% set title %}Edit User{% endset %}
  {% set gravatarHash %}{{ user.gravatarEmailHash }}{% endset %}
{% else %}
  {% set title %}New User{% endset %}
  {% set gravatarHash %}{% endset %}
{% endif %}

{% block page_title title %}

{% form_theme form _self %}
{% block _user_name_widget %}
    <input class="textbox activate" size="32" type="text" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock %}
{% block _user_email_widget %}
    <input class="textbox" size="32" type="text" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock %}
{% block _user_username_widget %}
    <input class="textbox" size="32" type="text" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock %}
{% block _user_password_widget %}
    <input class="textbox big" size="15" type="password" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock %}
{% block _user_password_confirm_widget %}
    <input class="textbox big" size="15" type="password" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock %}
{% block _user_notes_widget %}
{% spaceless %}
    <textarea class="textarea" cols="53" rows="4" {{ block('widget_attributes') }}>{{ value }}</textarea>
{% endspaceless %}
{% endblock %}

{% block content %}  
    {% if user is defined %} 
    <h1>{% trans %}Edit User{% endtrans %}</h1>
    <form class="edit_user" action="{{ url('user_update', { 'id' : user.id }) }}" method="post" {{ form_enctype(form) }}>
    {% else %}
    <h1>{% trans %}New User{% endtrans %}</h1>
    <form class="edit_user" action="{{ url('user_new') }}" method="post" {{ form_enctype(form) }}>
    {% endif %}

        <div id="avatar">
          <img width="80" height="80" src="http://www.gravatar.com/avatar/{{gravatarHash}}" class="avatar" alt="" />
          <p class="caption">Avatar provided by Gravatar.com</p>
        </div>

        <p>
            {{ form_label(form.name) }}
            {{ form_widget(form.name) }}
            {{ form_errors(form.name) }}
        </p>
      
        <p>
            {{ form_label(form.username) }}
            {{ form_widget(form.username) }}
            {{ form_errors(form.username) }}
        </p>
      
        <p>
            {{ form_label(form.email) }}
            {{ form_widget(form.email) }}
            {{ form_errors(form.email) }}
        </p>
      
        <p id="display_password" class="{% if form_errors(form.password) %}hide{% else %}display{% endif %}">
            <label>{% trans %}Password{% endtrans %}</label>
            <span class="value">
              •••••
              <a id="change-password-link" href="#" class="action">{% trans %}Change{% endtrans %}</a>
            </span>
        </p>

        <div class="set change-password {% if form_errors(form.password) %}display{% else %}hide{% endif %}">
            <p>
                {{ form_label(form.password) }}
                {{ form_widget(form.password, { 'attr' : { 'class' : 'input-password' } }) }}
                {{ form_errors(form.password) }}
            </p>

            <p>
                {{ form_label(form.password_confirm) }}
                {{ form_widget(form.password_confirm, { 'attr' : { 'class' : 'input-password' } }) }}
                {{ form_errors(form.password_confirm) }}
                <span>
                    {% trans %} or {% endtrans %}
                    <a id="cancel-change-password-link" href="#" class="action">{% trans %}Cancel{% endtrans %}</a>
                </span>
            </p>
        </div>

        <p>
            {{ form_label(form.user_roles) }}
            {{ form_widget(form.user_roles) }}
            {{ form_errors(form.user_roles) }}
        </p>
        
        <p>
            {{ form_label(form.language) }}
            {{ form_widget(form.language) }}
            {{ form_errors(form.language) }}
        </p>
        
        <p>
            {{ form_label(form.notes) }}
            {{ form_widget(form.notes) }}
            {{ form_errors(form.notes) }}
        </p>
        {{ form_rest(form) }}
      
        <p class="buttons">
            <input accesskey="S" class="button" type="submit" value="{% trans %}Save Changes{% endtrans %}" name="save" />
            {% trans %}or{% endtrans %}
            <a href="{{ url('user_list') }}">{% trans %}Cancel{% endtrans %}</a>
        </p>
        {# <p class="updated_line">
          {% trans %}Last Updated by <strong>Administrator</strong> at 07:27 am on January 02, 2009{% endtrans %}
        </p> #}
    </form>
{% endblock %}
