{% extends "SadiantCmsBundle::layout.html.twig" %}

{% block javascripts_assets %}
<script src="{{ asset('bundles/sadiantcms/js/user.js') }}" type="text/javascript"></script>
{% endblock %}

{% set body_class = 'reversed' %}
{% set tab = 'settings' %}
{% set nav = 'users' %}

{% if user is defined %}
  {% set title %}Edit User{% endset %}
  {% set gravatarHash %}{{ user.gravatarEmailHash }}{% endset %}
{% else %}
  {% set title %}New User{% endset %}
  {% set gravatarHash %}{% endset %}
{% endif %}

{% block page_title title %}

{% block content %}  
    {% if user is defined %} 
    <h1>{% trans %}Edit User{% endtrans %}</h1>
    <form class="edit_user" action="{{ url('user_update', { 'id' : user.id }) }}" method="post" {{ form_enctype(form) }}>
    {% else %}
    <h1>{% trans %}New User{% endtrans %}</h1>
    <form class="edit_user" action="{{ url('user_new') }}" method="post" {{ form_enctype(form) }}>
    {% endif %}

        <div id="avatar">
          <img width="80" height="80" src="http://www.gravatar.com/avatar/{{gravatarHash}}" class="avatar" alt="" />
          <p class="caption">Avatar provided by Gravatar.com</p>
        </div>

        <div>
            {{ form_label(form.name) }}
            {{ form_widget(form.name) }}
            {{ form_errors(form.name) }}
        </div>
      
        <div>
            {{ form_label(form.username) }}
            {{ form_widget(form.username) }}
            {{ form_errors(form.username) }}
        </div>
      
        <div>
            {{ form_label(form.email) }}
            {{ form_widget(form.email) }}
            {{ form_errors(form.email) }}
        </div>
      
        <p id="display_password" class="{% if form_errors(form.password) %}hide{% else %}display{% endif %}">
            <label>{% trans %}Password{% endtrans %}</label>

            <span class="value">
              •••••
              <a id="change-password-link" href="#" class="action">{% trans %}Change{% endtrans %}</a>
            </span>
        </p>

        <div class="change-password {% if form_errors(form.password) %}display{% else %}hide{% endif %}">
            <span>
                {{ form_label(form.password) }}
                {{ form_widget(form.password, { 'attr' : { 'class' : 'input-password' } }) }}
                {{ form_errors(form.password) }}
            </span>

            <span>
                {{ form_label(form.password_confirm) }}
                {{ form_widget(form.password_confirm, { 'attr' : { 'class' : 'input-password' } }) }}
                {{ form_errors(form.password_confirm) }}
            </span>
          
            <span>
                {% trans %} or {% endtrans %}
                <a id="cancel-change-password-link" href="#" class="action">{% trans %}Cancel{% endtrans %}</a>
            </span>
        </div>
        
        <div>
            {{ form_label(form.language) }}
            {{ form_widget(form.language) }}
            {{ form_errors(form.language) }}
        </div>
        
        <div>
            {{ form_label(form.notes) }}
            {{ form_widget(form.notes) }}
            {{ form_errors(form.notes) }}
        </div>
        
        <div>
            {{ form_label(form.user_roles) }}
            {{ form_widget(form.user_roles) }}
            {{ form_errors(form.user_roles) }}
        </div>

        {{ form_rest(form) }}
      
        <p class="buttons" style="clear: left;">
            <input accesskey="S" class="button" type="submit" value="{% trans %}Save Changes{% endtrans %}" name="save" />
            {% trans %}or{% endtrans %}
            <a href="{{ url('user_list') }}">{% trans %}Cancel{% endtrans %}</a>
        </p>
    </form>
{% endblock %}
