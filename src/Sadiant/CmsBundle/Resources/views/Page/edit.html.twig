{% extends "SadiantCmsBundle::layout.html.twig" %}

{% set tab = 'content' %}
{% set nav = 'pages' %}

{% block javascripts_assets %}
<script src="{{ asset('bundles/sadiantcms/js/page.js') }}" type="text/javascript"></script>
{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('bundles/sadiantcms/css/page.css') }}" type="text/css" media="all" />
{% endblock %}

{% block page_title "Pages" %}

{% block content %}
  <div>
    {% if page is defined %} 
    <h1>{% trans %}Edit page{% endtrans %}</h1>
    <form action="{{ url('page_update', { 'id': page.id }) }}" method="post" {{ form_enctype(form) }}>
    {% elseif parent_page == 'homepage' %}
      <h1>{% trans %}New page{% endtrans %}</h1>
      <form action="{{ url('page_new', { 'id': 'homepage' }) }}" method="post" {{ form_enctype(form) }}>
    {% else %}
    <h1>{% trans %}New page{% endtrans %}</h1>
    <form action="{{ url('page_new', { 'id': parent_page.id }) }}" method="post" {{ form_enctype(form) }}>
    {% endif %}

      <div>
        {{ form_errors(form.name) }}
        {{ form_label(form.name) }}
        {{ form_widget(form.name) }}
      </div>
      
      <a id="link-more-fields" class="extra-fields-link {% if (hasErrors is not defined) or not hasErrors %}display{% else %}hide{% endif %}" href="#">
        {% trans %}More{% endtrans %}
      </a>
      
      <a id="link-less-fields" class="extra-fields-link {% if (hasErrors is defined) and hasErrors %}display{% else %}hide{% endif %}" href="#">
        {% trans %}Less{% endtrans %}
      </a>

      <div id="extra-fields" class="{% if (hasErrors is defined) and hasErrors %}display{% else %}hide{% endif %}">
        <div>
          {{ form_errors(form.slug) }}
          {{ form_label(form.slug) }}
          {{ form_widget(form.slug) }}
        </div>

        <div>
          {{ form_errors(form.breadcrumb) }}
          {{ form_label(form.breadcrumb) }}
          {{ form_widget(form.breadcrumb) }}
        </div>

        <div>
          {{ form_errors(form.description) }}
          {{ form_label(form.description) }}
          {{ form_widget(form.description) }}
        </div>
      </div>
      
      <div>
        {{ form_errors(form.content) }}
        {{ form_label(form.content) }}
        {{ form_widget(form.content) }}
      </div>

      <div>
        {{ form_errors(form.status) }}
        {{ form_label(form.status) }}
        {{ form_widget(form.status) }}
      </div>
      
      {% if isNew is not defined or not isNew %}
        <div>
          {{ form_errors(form.published_at) }}
          {{ form_label(form.published_at) }}
          {{ form_widget(form.published_at) }}
        </div>
      {% endif %}
      
      {{ form_rest(form) }}

      <input type="submit" value="{% trans %}Save{% endtrans %}" name="save-and-list" />
      <input type="submit" value="{% trans %}Save and continue editing{% endtrans %}"  name="save-and-edit" />

      <a href="{{ url('page_list') }}">{% trans %}Cancel{% endtrans %}</a>
    </form>
  </div>
{% endblock %}
